# SWCAPSTONE
1. m5 competition에서 공식 데이터를 다운로드 후 data 폴더에 저장
2. preprocessing code 실행 
3. model 학습은 train code 실행 
4. test 평가는 predict로 csv 파일 생성후 R을 활용하여 따로 실행

과제 개요
   가. 과제 설계 배경 및 필요성

 대부분의 많은 카테고리의 산업에서 어떠한 사업을 기획할 때 항상 시작은 demand forecasting으로 시작합니다. 예를 들어 금융 분야에서는 과거 고객 재무 정보를 토대로 심사를 고도화하고 리스크를 관리하는 데에 쓰일 수 있고, 마케팅과 세일즈 업무에서는 이벤트의 성공률이나 제품의 구매율을 예측하여 타겟 고객을 엄밀히 세그먼팅할 수 있으며, 제조 분야에서는 불량품을 자동으로 검출하고 공정 프로세스를 최적화하는 데에 쓰일 수 있습니다. 
 이러한 demand forecasting 관련 competition으로 약 40년 전 M1이 처음 열렸고 그 당시에는전통 통계 기반인 ARIMA관련 모델이 성능이 가장 정확하게 나왔습니다. 이런 전통 통계 기반 모델들이 2000년에 열린 M3 대회까지 가장 좋은 성능을 내었습니다. 하지만 M4에서는 전통 통계 그리고 ML 기법을 통합한 모델이 top-score를 기록하였고 가장 최근 대회인 M5의 수상팀들은 과거와 다르게 ML/DL 모델들이 top-30 안에 들어간 비율이 높아졌습니다. 이렇듯 점점 demand forecasting 분야에서 ML/DL이 차지하는 비중이 높아짐에 따라서 해당 주제에 대한 ML/DL 기술 접목에 대한 연구가 중요하다고 생각합니다.

   나. 과제 주요내용

  m5는 forecasting 관련 대회이며 약 5년의 Walmart retail data를 활용하여 추후 28일의 retail demand를 정확하게 예측하는 것이 과제였습니다. 

 해당 대회의 결과를 간단하게 요약하자면 이전 forecasting 대회보다 대다수의 우승팀들의 방식이 
ml로 전환되는 양상이 나왔습니다. (top50 중 45팀이 LGBM 사용) 또한 많은 팀들이 데이터 구조의 
특성상 각 계층마다 다른 model을 생성하였습니다. 이러한 방식은 학습시키는 모델 수의 증가를 불
러왔습니다. winning method 또한 220개의 model을 생성 후 각각 처음부터 새로 학습을 시켜서 예
측을 수행을 하였습니다. 대다수의 winning method에서 소개한 다중 모델 생성 방식으로 인한 문제점은 아래와 같습니다. 이는 m5 competition 관련 여러 논문에서 발표한 문제점들을 정리한 것입니다.
 
 1. 단일 모델이 아닌 데이터의 계층 단위로 모델을 생성한 경우에 각각 모델에 대한 최적화를 진행하는데 무리가 있음
 2. 계절성 또는 판촉 효과와 같은 명백한 유사점이 시계열의 계층 구조 전체에 존재함에도 불구하
고 이러한 방법은 각 상점, 카테고리 또는 부서에 대해 여러 ML 모델을 처음부터 교육해야 한다는 
사실에서 계산 부담이 크게 발생
 3. 추후 실제 산업에 적용 시 계산량에 대한 부담 때문에 잘 진행이 안 될 수 있음
 • 데이터가 더 많은 case에 적용하려면 많은 computing resource 가 필요
 4. 상대적으로 데이터의 크기가 작은 최하위 계층에 대해서는 예측 정확도의 성능이 저조
 


 위와 같은 문제를 해결하기 위해서 비슷한 데이터 분포를 가지는 모델을 학습할 때에는 처음부터 
모델을 학습시키는 것이 아닌 source model을 먼저 fully train을 진행한 후 parameter transfer 
approach를 사용해서 모델이 처음부터 학습하는 것을 방지함으로 computational cost를 감소시키고 
상대적으로 예측 정확도가 낮은 하위 계층의 정확도를 증가를 도모하는 TL 기반 학습 Framework를 
연구하고자 합니다. 
  
   다. 최종결과물의 목표

 모든 계층별로 (store:10개) 전부 하이퍼 파라미터 튜닝 그리고 fully training을 시키는 것이 아닌 Base 모델을 한 개 설정 후 해당 모델만 하이퍼 파라미터 튜닝을 해서 모델 구조 전이를 통한 다른 store 혹은 state에 대해서 예측을 수행했을 때 computational cost는 감소되고 성능은 fully train 시키는 경우의 값과 비슷하거나 우수하게 나오는 것이 목표입니다.

1. 정량적 목표
Transfer-ML의 성능을 WRMSSE, RMSE, Time Cost 측면으로 기존의 방법론들과 비교 분석
2. 정성적 목표
Transfer-ML의 시도를 통한 실험 과정, 시행착오 및 추후 연구 개선점 정리 
